
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lazy_group_by/">
      
      
        <link rel="next" href="../schema/">
      
      
      <link rel="icon" href="../../assets/logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>narwhals.LazyFrame - Narwhals</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#narwhalslazyframe" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Narwhals" class="md-header__button md-logo" aria-label="Narwhals" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Narwhals
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              narwhals.LazyFrame
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/narwhals-dev/narwhals.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Narwhals" class="md-nav__button md-logo" aria-label="Narwhals" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    Narwhals
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/narwhals-dev/narwhals.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../why/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation and quick start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Intro tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Intro tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DataFrame
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/complete_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Complete example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/dataframe_conversion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conversion between libraries
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generating_sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Narwhals and SQL
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/order_dependence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Order-dependence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/pandas_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What about the pandas Index?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/improve_group_by_operation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Avoiding the UserWarning error while using Pandas group_by
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/column_names/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Column names
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/boolean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boolean columns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/null_handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Null/NaN handling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overhead/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overhead
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backcompat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Perfect backwards compatibility policy
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extending/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported libraries and extending Narwhals
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_it_works/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How it works
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ecosystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ecosystem
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api-completeness/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Completeness
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_14" id="__nav_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            API Completeness
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported DataFrame methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/lazyframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported LazyFrame methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/expr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Expr methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/expr_cat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Expr.cat methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/expr_dt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Expr.dt methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/expr_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Expr.list methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/expr_name/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Expr.name methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/expr_str/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Expr.str methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/expr_struct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Expr.struct methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Series methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/series_cat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Series.cat methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/series_dt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Series.dt methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/series_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Series.list methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/series_str/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Series.str methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-completeness/series_struct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Series.struct methods
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15" id="__nav_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../narwhals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Top-level functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.DataFrame
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Expr
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr_cat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Expr.cat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr_dt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Expr.dt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Expr.list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr_name/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Expr.name
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr_str/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Expr.str
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr_struct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Expr.struct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../group_by/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.GroupBy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lazy_group_by/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.LazyGroupBy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    narwhals.LazyFrame
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    narwhals.LazyFrame
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame" class="md-nav__link">
    <span class="md-ellipsis">
      LazyFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.columns" class="md-nav__link">
    <span class="md-ellipsis">
      columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.implementation" class="md-nav__link">
    <span class="md-ellipsis">
      implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.schema" class="md-nav__link">
    <span class="md-ellipsis">
      schema
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.collect" class="md-nav__link">
    <span class="md-ellipsis">
      collect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.collect_schema" class="md-nav__link">
    <span class="md-ellipsis">
      collect_schema
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.drop" class="md-nav__link">
    <span class="md-ellipsis">
      drop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.drop_nulls" class="md-nav__link">
    <span class="md-ellipsis">
      drop_nulls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.explode" class="md-nav__link">
    <span class="md-ellipsis">
      explode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.filter" class="md-nav__link">
    <span class="md-ellipsis">
      filter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.gather_every" class="md-nav__link">
    <span class="md-ellipsis">
      gather_every
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.group_by" class="md-nav__link">
    <span class="md-ellipsis">
      group_by
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.head" class="md-nav__link">
    <span class="md-ellipsis">
      head
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.join_asof" class="md-nav__link">
    <span class="md-ellipsis">
      join_asof
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.lazy" class="md-nav__link">
    <span class="md-ellipsis">
      lazy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.pipe" class="md-nav__link">
    <span class="md-ellipsis">
      pipe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.rename" class="md-nav__link">
    <span class="md-ellipsis">
      rename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.select" class="md-nav__link">
    <span class="md-ellipsis">
      select
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.sink_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      sink_parquet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.tail" class="md-nav__link">
    <span class="md-ellipsis">
      tail
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.to_native" class="md-nav__link">
    <span class="md-ellipsis">
      to_native
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.top_k" class="md-nav__link">
    <span class="md-ellipsis">
      top_k
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.unique" class="md-nav__link">
    <span class="md-ellipsis">
      unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.unpivot" class="md-nav__link">
    <span class="md-ellipsis">
      unpivot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.with_columns" class="md-nav__link">
    <span class="md-ellipsis">
      with_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.with_row_index" class="md-nav__link">
    <span class="md-ellipsis">
      with_row_index
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../series_cat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Series.cat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../series_dt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Series.dt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../series_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Series.list
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../series_str/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Series.str
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../series_struct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Series.struct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dependencies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.dependencies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dtypes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.dtypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../selectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.selectors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../typing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.typing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    narwhals.utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../this/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    This
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame" class="md-nav__link">
    <span class="md-ellipsis">
      LazyFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.columns" class="md-nav__link">
    <span class="md-ellipsis">
      columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.implementation" class="md-nav__link">
    <span class="md-ellipsis">
      implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.schema" class="md-nav__link">
    <span class="md-ellipsis">
      schema
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.collect" class="md-nav__link">
    <span class="md-ellipsis">
      collect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.collect_schema" class="md-nav__link">
    <span class="md-ellipsis">
      collect_schema
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.drop" class="md-nav__link">
    <span class="md-ellipsis">
      drop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.drop_nulls" class="md-nav__link">
    <span class="md-ellipsis">
      drop_nulls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.explode" class="md-nav__link">
    <span class="md-ellipsis">
      explode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.filter" class="md-nav__link">
    <span class="md-ellipsis">
      filter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.gather_every" class="md-nav__link">
    <span class="md-ellipsis">
      gather_every
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.group_by" class="md-nav__link">
    <span class="md-ellipsis">
      group_by
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.head" class="md-nav__link">
    <span class="md-ellipsis">
      head
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.join_asof" class="md-nav__link">
    <span class="md-ellipsis">
      join_asof
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.lazy" class="md-nav__link">
    <span class="md-ellipsis">
      lazy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.pipe" class="md-nav__link">
    <span class="md-ellipsis">
      pipe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.rename" class="md-nav__link">
    <span class="md-ellipsis">
      rename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.select" class="md-nav__link">
    <span class="md-ellipsis">
      select
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.sink_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      sink_parquet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.tail" class="md-nav__link">
    <span class="md-ellipsis">
      tail
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.to_native" class="md-nav__link">
    <span class="md-ellipsis">
      to_native
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.top_k" class="md-nav__link">
    <span class="md-ellipsis">
      top_k
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.unique" class="md-nav__link">
    <span class="md-ellipsis">
      unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.unpivot" class="md-nav__link">
    <span class="md-ellipsis">
      unpivot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.with_columns" class="md-nav__link">
    <span class="md-ellipsis">
      with_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#narwhals.dataframe.LazyFrame.with_row_index" class="md-nav__link">
    <span class="md-ellipsis">
      with_row_index
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="narwhalslazyframe"><code>narwhals.LazyFrame</code></h1>


<div class="doc doc-object doc-class">



<a id="narwhals.dataframe.LazyFrame"></a>
    <div class="doc doc-contents first">


        <p>Narwhals LazyFrame, backed by a native lazyframe.</p>


<details class="warning" open>
  <summary>Warning</summary>
  <p>This class is not meant to be instantiated directly - instead use
<a class="autorefs autorefs-internal" title="from_native" href="../narwhals/#narwhals.from_native"><code>narwhals.from_native</code></a> with a native
object that is a lazy dataframe from one of the supported
backend (e.g. polars.LazyFrame, dask_expr._collection.DataFrame):
<div class="highlight"><pre><span></span><code><span class="n">narwhals</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">native_lazyframe</span><span class="p">)</span>
</code></pre></div></p>
</details>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="narwhals.dataframe.LazyFrame.columns" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">columns</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get column names.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 4.5), (3, 2.) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="narwhals.dataframe.LazyFrame.implementation" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">implementation</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">implementation</span><span class="p">:</span> <span class="n">_Implementation</span> <span class="o">=</span> <span class="n">_Implementation</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return <a class="autorefs autorefs-internal" href="../implementation/#narwhals.Implementation"><code>narwhals.Implementation</code></a> of native frame.</p>
<p>This can be useful when you need to use special-casing for features outside of
Narwhals' scope - for example, when dealing with pandas' Period Dtype.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">implementation</span>
<span class="go">&lt;Implementation.PANDAS: &#39;pandas&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">implementation</span><span class="o">.</span><span class="n">is_pandas</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">implementation</span><span class="o">.</span><span class="n">is_pandas_like</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">implementation</span><span class="o">.</span><span class="n">is_polars</span><span class="p">()</span>
<span class="go">False</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="narwhals.dataframe.LazyFrame.schema" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">schema</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">schema</span><span class="p">:</span> <span class="n">Schema</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get an ordered mapping of column names to their data type.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 4.5), (3, 2.) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span>
<span class="go">Schema({&#39;a&#39;: Int32, &#39;b&#39;: Decimal})</span>
</code></pre></div>

    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.collect" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">collect</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">collect</span><span class="p">(</span>
    <span class="n">backend</span><span class="p">:</span> <span class="p">(</span>
        <span class="n">IntoBackend</span><span class="p">[</span><span class="n">Polars</span> <span class="o">|</span> <span class="n">Pandas</span> <span class="o">|</span> <span class="n">Arrow</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Materialize this LazyFrame into a DataFrame.</p>
<p>As each underlying lazyframe has different arguments to set when materializing
the lazyframe into a dataframe, we allow to pass them as kwargs (see examples
below for how to generalize the specification).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>backend</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IntoBackend


  
      module-attribute
   (narwhals._typing.IntoBackend)" href="../typing/#narwhals.typing.IntoBackend">IntoBackend</a>[<span title="narwhals._typing.Polars">Polars</span> | <span title="narwhals._typing.Pandas">Pandas</span> | <span title="narwhals._typing.Arrow">Arrow</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specifies which eager backend collect to. This will be the underlying
backend for the resulting Narwhals DataFrame. If None, then the following
default conversions will be applied</p>
<ul>
<li><code>polars.LazyFrame</code> -&gt; <code>polars.DataFrame</code></li>
<li><code>dask.DataFrame</code> -&gt; <code>pandas.DataFrame</code></li>
<li><code>duckdb.PyRelation</code> -&gt; <code>pyarrow.Table</code></li>
<li><code>pyspark.DataFrame</code> -&gt; <code>pyarrow.Table</code></li>
</ul>
<p><code>backend</code> can be specified in various ways</p>
<ul>
<li>As <code>Implementation.&lt;BACKEND&gt;</code> with <code>BACKEND</code> being <code>PANDAS</code>, <code>PYARROW</code>
    or <code>POLARS</code>.</li>
<li>As a string: <code>"pandas"</code>, <code>"pyarrow"</code> or <code>"polars"</code></li>
<li>Directly as a module <code>pandas</code>, <code>pyarrow</code> or <code>polars</code>.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>backend specific kwargs to pass along. To know more please check the
backend specific documentation</p>
<ul>
<li><a href="https://docs.pola.rs/api/python/dev/reference/lazyframe/api/polars.LazyFrame.collect.html">polars.LazyFrame.collect</a></li>
<li><a href="https://docs.dask.org/en/stable/generated/dask.dataframe.DataFrame.compute.html">dask.dataframe.DataFrame.compute</a></li>
</ul>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 2), (3, 4) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span>
<span class="go">┌──────────────────┐</span>
<span class="go">|Narwhals LazyFrame|</span>
<span class="go">|------------------|</span>
<span class="go">|┌───────┬───────┐ |</span>
<span class="go">|│   a   │   b   │ |</span>
<span class="go">|│ int32 │ int32 │ |</span>
<span class="go">|├───────┼───────┤ |</span>
<span class="go">|│     1 │     2 │ |</span>
<span class="go">|│     3 │     4 │ |</span>
<span class="go">|└───────┴───────┘ |</span>
<span class="go">└──────────────────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">┌──────────────────┐</span>
<span class="go">|Narwhals DataFrame|</span>
<span class="go">|------------------|</span>
<span class="go">|  pyarrow.Table   |</span>
<span class="go">|  a: int32        |</span>
<span class="go">|  b: int32        |</span>
<span class="go">|  ----            |</span>
<span class="go">|  a: [[1,3]]      |</span>
<span class="go">|  b: [[2,4]]      |</span>
<span class="go">└──────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.collect_schema" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">collect_schema</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">collect_schema</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Schema</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get an ordered mapping of column names to their data type.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 4.5), (3, 2.) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">collect_schema</span><span class="p">()</span>
<span class="go">Schema({&#39;a&#39;: Int32, &#39;b&#39;: Decimal})</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.drop" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">drop</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">drop</span><span class="p">(</span>
    <span class="o">*</span><span class="n">columns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Remove columns from the LazyFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*columns</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="collections.abc.Iterable">Iterable</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the columns that should be removed from the dataframe.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Validate that all column names exist in the schema and throw an
exception if a column name does not exist in the schema.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="warning" open>
  <summary>Warning</summary>
  <p><code>strict</code> argument is ignored for <code>polars&lt;1.0.0</code>.</p>
<p>Please consider upgrading to a newer version or pass to eager mode.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 2), (3, 4) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┐</span>
<span class="go">│   b   │</span>
<span class="go">│ int32 │</span>
<span class="go">├───────┤</span>
<span class="go">│     2 │</span>
<span class="go">│     4 │</span>
<span class="go">└───────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.drop_nulls" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">drop_nulls</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">drop_nulls</span><span class="p">(</span><span class="n">subset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Drop rows that contain null values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>subset</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name(s) for which null values are considered. If set to None
(default), use all columns.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>pandas handles null values differently from Polars and PyArrow.
See <a href="../../concepts/null_handling/">null_handling</a> for reference.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, NULL), (3, 4) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">()</span>
<span class="go">┌──────────────────┐</span>
<span class="go">|Narwhals LazyFrame|</span>
<span class="go">|------------------|</span>
<span class="go">|┌───────┬───────┐ |</span>
<span class="go">|│   a   │   b   │ |</span>
<span class="go">|│ int32 │ int32 │ |</span>
<span class="go">|├───────┼───────┤ |</span>
<span class="go">|│     3 │     4 │ |</span>
<span class="go">|└───────┴───────┘ |</span>
<span class="go">└──────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.explode" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">explode</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explode</span><span class="p">(</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">*</span><span class="n">more_columns</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Explode the dataframe to long format by exploding the given columns.</p>


<details class="notes" open>
  <summary>Notes</summary>
  <p>It is possible to explode multiple columns only if these columns have
matching element counts.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column names. The underlying columns being exploded must be of the <code>List</code> data type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*more_columns</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional names of columns to explode, specified as positional arguments.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT * FROM VALUES (&#39;x&#39;, [1, 2]), (&#39;y&#39;, [3, 4]), (&#39;z&#39;, [5, 6]) df(a, b)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌─────────┬───────┐</span>
<span class="go">│    a    │   b   │</span>
<span class="go">│ varchar │ int32 │</span>
<span class="go">├─────────┼───────┤</span>
<span class="go">│ x       │     1 │</span>
<span class="go">│ x       │     2 │</span>
<span class="go">│ y       │     3 │</span>
<span class="go">│ y       │     4 │</span>
<span class="go">│ z       │     5 │</span>
<span class="go">│ z       │     6 │</span>
<span class="go">└─────────┴───────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.filter" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">filter</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">filter</span><span class="p">(</span>
    <span class="o">*</span><span class="n">predicates</span><span class="p">:</span> <span class="n">IntoExpr</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">IntoExpr</span><span class="p">],</span>
    <span class="o">**</span><span class="n">constraints</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Filter the rows in the LazyFrame based on a predicate expression.</p>
<p>The original order of the remaining rows is preserved.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*predicates</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a> | <span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expression(s) that evaluates to a boolean Series.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**constraints</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column filters; use <code>name = value</code> to filter columns by the supplied value.
Each constraint will behave the same as <code>nw.col(name).eq(value)</code>, and will be implicitly
joined with the other filter conditions using &amp;.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    SELECT * FROM VALUES</span>
<span class="gp">... </span><span class="s1">        (1, 6, &#39;a&#39;),</span>
<span class="gp">... </span><span class="s1">        (2, 7, &#39;b&#39;),</span>
<span class="gp">... </span><span class="s1">        (3, 8, &#39;c&#39;)</span>
<span class="gp">... </span><span class="s1">    df(foo, bar, ham)</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</code></pre></div>
    <p>Filter on one condition</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┬───────┬─────────┐</span>
<span class="go">│  foo  │  bar  │   ham   │</span>
<span class="go">│ int32 │ int32 │ varchar │</span>
<span class="go">├───────┼───────┼─────────┤</span>
<span class="go">│     2 │     7 │ b       │</span>
<span class="go">│     3 │     8 │ c       │</span>
<span class="go">└───────┴───────┴─────────┘</span>
</code></pre></div>
    <p>Filter on multiple conditions with implicit <code>&amp;</code></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;ham&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┬───────┬─────────┐</span>
<span class="go">│  foo  │  bar  │   ham   │</span>
<span class="go">│ int32 │ int32 │ varchar │</span>
<span class="go">├───────┼───────┼─────────┤</span>
<span class="go">│     1 │     6 │ a       │</span>
<span class="go">└───────┴───────┴─────────┘</span>
</code></pre></div>
    <p>Filter on multiple conditions with <code>|</code></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;ham&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┬───────┬─────────┐</span>
<span class="go">│  foo  │  bar  │   ham   │</span>
<span class="go">│ int32 │ int32 │ varchar │</span>
<span class="go">├───────┼───────┼─────────┤</span>
<span class="go">│     1 │     6 │ a       │</span>
<span class="go">│     3 │     8 │ c       │</span>
<span class="go">└───────┴───────┴─────────┘</span>
</code></pre></div>
    <p>Filter using <code>**kwargs</code> syntax</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ham</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┬───────┬─────────┐</span>
<span class="go">│  foo  │  bar  │   ham   │</span>
<span class="go">│ int32 │ int32 │ varchar │</span>
<span class="go">├───────┼───────┼─────────┤</span>
<span class="go">│     2 │     7 │ b       │</span>
<span class="go">└───────┴───────┴─────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.gather_every" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">gather_every</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">gather_every</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.group_by" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">group_by</span>


</h2>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">group_by</span><span class="p">(</span>
    <span class="o">*</span><span class="n">keys</span><span class="p">:</span> <span class="n">IntoExpr</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">IntoExpr</span><span class="p">],</span>
    <span class="n">drop_null_keys</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LazyGroupBy</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">group_by</span><span class="p">(</span>
    <span class="o">*</span><span class="n">keys</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">drop_null_keys</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LazyGroupBy</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">group_by</span><span class="p">(</span>
    <span class="o">*</span><span class="n">keys</span><span class="p">:</span> <span class="n">IntoExpr</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">IntoExpr</span><span class="p">],</span>
    <span class="n">drop_null_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LazyGroupBy</span><span class="p">[</span><span class="n">Self</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Start a group by operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*keys</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a> | <span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to group by. Accepts expression input. Strings are parsed as
column names.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_null_keys</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, then groups where any key is null won't be
included in the result.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT * FROM VALUES (1, &#39;a&#39;), (2, &#39;b&#39;), (3, &#39;a&#39;) df(a, b)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌─────────┬────────┐</span>
<span class="go">│    b    │   a    │</span>
<span class="go">│ varchar │ int128 │</span>
<span class="go">├─────────┼────────┤</span>
<span class="go">│ a       │      4 │</span>
<span class="go">│ b       │      2 │</span>
<span class="go">└─────────┴────────┘</span>
</code></pre></div>
    <p>Expressions are also accepted.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len_chars</span><span class="p">())</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┬────────┐</span>
<span class="go">│   b   │   a    │</span>
<span class="go">│ int64 │ int128 │</span>
<span class="go">├───────┼────────┤</span>
<span class="go">│     1 │      6 │</span>
<span class="go">└───────┴────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.head" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">head</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">head</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get <code>n</code> rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rows to return.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">dask.dataframe</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]},</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">┌──────────────────┐</span>
<span class="go">|Narwhals DataFrame|</span>
<span class="go">|------------------|</span>
<span class="go">|        a  b      |</span>
<span class="go">|     0  1  4      |</span>
<span class="go">|     1  2  5      |</span>
<span class="go">└──────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.join" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">join</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">join</span><span class="p">(</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">how</span><span class="p">:</span> <span class="n">JoinStrategy</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">left_on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">right_on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_right&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a join operation to the Logical Plan.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lazy DataFrame to join with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name(s) of the join columns in both DataFrames. If set, <code>left_on</code> and
<code>right_on</code> should be None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>how</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="JoinStrategy


  
      module-attribute
   (narwhals.typing.JoinStrategy)" href="../typing/#narwhals.typing.JoinStrategy">JoinStrategy</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Join strategy.</p>
<ul>
<li><em>inner</em>: Returns rows that have matching values in both tables.</li>
<li><em>left</em>: Returns all rows from the left table, and the matched rows from the right table.</li>
<li><em>full</em>: Returns all rows in both dataframes, with the suffix appended to the right join keys.</li>
<li><em>cross</em>: Returns the Cartesian product of rows from both tables.</li>
<li><em>semi</em>: Filter rows that have a match in the right table.</li>
<li><em>anti</em>: Filter rows that do not have a match in the right table.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;inner&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>left_on</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Join column of the left DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>right_on</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Join column of the right DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suffix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Suffix to append to columns with a duplicate name.</p>
              </div>
            </td>
            <td>
                  <code>&#39;_right&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native1</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT * FROM VALUES (1, &#39;a&#39;), (2, &#39;b&#39;) df(a, b)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native2</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT * FROM VALUES (1, &#39;x&#39;), (3, &#39;y&#39;) df(a, c)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="go">┌─────────────────────────────┐</span>
<span class="go">|     Narwhals LazyFrame      |</span>
<span class="go">|-----------------------------|</span>
<span class="go">|┌───────┬─────────┬─────────┐|</span>
<span class="go">|│   a   │    b    │    c    │|</span>
<span class="go">|│ int32 │ varchar │ varchar │|</span>
<span class="go">|├───────┼─────────┼─────────┤|</span>
<span class="go">|│     1 │ a       │ x       │|</span>
<span class="go">|└───────┴─────────┴─────────┘|</span>
<span class="go">└─────────────────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.join_asof" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">join_asof</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">join_asof</span><span class="p">(</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">left_on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">right_on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_left</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_right</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">AsofJoinStrategy</span> <span class="o">=</span> <span class="s2">&quot;backward&quot;</span><span class="p">,</span>
    <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_right&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform an asof join.</p>
<p>This is similar to a left-join except that we match on nearest key rather than equal keys.</p>
<p>For Polars, both DataFrames must be sorted by the <code>on</code> key (within each <code>by</code> group
if specified).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to join with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>left_on</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name(s) of the left join column(s).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>right_on</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name(s) of the right join column(s).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Join column of both DataFrames. If set, left_on and right_on should be None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>by_left</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>join on these columns before doing asof join</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>by_right</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>join on these columns before doing asof join</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>join on these columns before doing asof join</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AsofJoinStrategy


  
      module-attribute
   (narwhals.typing.AsofJoinStrategy)" href="../typing/#narwhals.typing.AsofJoinStrategy">AsofJoinStrategy</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Join strategy. The default is "backward".</p>
<ul>
<li><em>backward</em>: selects the last row in the right DataFrame whose "on" key is less than or equal to the left's key.</li>
<li><em>forward</em>: selects the first row in the right DataFrame whose "on" key is greater than or equal to the left's key.</li>
<li><em>nearest</em>: search selects the last row in the right DataFrame whose value is nearest to the left's key.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;backward&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suffix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Suffix to append to columns with a duplicate name.</p>
              </div>
            </td>
            <td>
                  <code>&#39;_right&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_gdp</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;datetime&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;gdp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4164</span><span class="p">,</span> <span class="mi">4411</span><span class="p">,</span> <span class="mi">4566</span><span class="p">,</span> <span class="mi">4696</span><span class="p">,</span> <span class="mi">4827</span><span class="p">],</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_population</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;datetime&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;population&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">82.19</span><span class="p">,</span> <span class="mf">82.66</span><span class="p">,</span> <span class="mf">83.12</span><span class="p">],</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gdp_native</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_gdp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">population_native</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_population</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gdp</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">gdp_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">population</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">population_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">population</span><span class="o">.</span><span class="n">join_asof</span><span class="p">(</span><span class="n">gdp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">shape: (3, 3)</span>
<span class="go">┌─────────────────────┬────────────┬──────┐</span>
<span class="go">│ datetime            ┆ population ┆ gdp  │</span>
<span class="go">│ ---                 ┆ ---        ┆ ---  │</span>
<span class="go">│ datetime[μs]        ┆ f64        ┆ i64  │</span>
<span class="go">╞═════════════════════╪════════════╪══════╡</span>
<span class="go">│ 2016-03-01 00:00:00 ┆ 82.19      ┆ 4164 │</span>
<span class="go">│ 2018-08-01 00:00:00 ┆ 82.66      ┆ 4566 │</span>
<span class="go">│ 2019-01-01 00:00:00 ┆ 83.12      ┆ 4696 │</span>
<span class="go">└─────────────────────┴────────────┴──────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.lazy" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lazy</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lazy</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Restrict available API methods to lazy-only ones.</p>
<p>This is a no-op, and exists only for compatibility with <code>DataFrame.lazy</code>.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.pipe" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">pipe</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">pipe</span><span class="p">(</span>
    <span class="n">function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">Concatenate</span><span class="p">[</span><span class="n">Self</span><span class="p">,</span> <span class="n">PS</span><span class="p">],</span> <span class="n">R</span><span class="p">],</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Pipe function call.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>function</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[<span title="typing_extensions.Concatenate">Concatenate</span>[<span title="typing_extensions.Self">Self</span>, <span title="narwhals.dataframe.PS">PS</span>], <span title="narwhals.dataframe.R">R</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to apply.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="narwhals.dataframe.PS.args">args</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments to pass to function.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="narwhals.dataframe.PS.kwargs">kwargs</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 2), (3, 4) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┐</span>
<span class="go">│   a   │</span>
<span class="go">│ int32 │</span>
<span class="go">├───────┤</span>
<span class="go">│     1 │</span>
<span class="go">│     3 │</span>
<span class="go">└───────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.rename" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rename</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rename</span><span class="p">(</span><span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Rename column names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Key value pairs that map from old name to new name, or a
      function that takes the old name as input and returns the
      new name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 4.5), (3, 2.) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">})</span>
<span class="go">┌────────────────────────┐</span>
<span class="go">|   Narwhals LazyFrame   |</span>
<span class="go">|------------------------|</span>
<span class="go">|┌───────┬──────────────┐|</span>
<span class="go">|│   c   │      b       │|</span>
<span class="go">|│ int32 │ decimal(2,1) │|</span>
<span class="go">|├───────┼──────────────┤|</span>
<span class="go">|│     1 │          4.5 │|</span>
<span class="go">|│     3 │          2.0 │|</span>
<span class="go">|└───────┴──────────────┘|</span>
<span class="go">└────────────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.select" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">select</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">select</span><span class="p">(</span>
    <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">IntoExpr</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">IntoExpr</span><span class="p">],</span>
    <span class="o">**</span><span class="n">named_exprs</span><span class="p">:</span> <span class="n">IntoExpr</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Select columns from this LazyFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*exprs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a> | <span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to select, specified as positional arguments.
Accepts expression input. Strings are parsed as column names.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**named_exprs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional columns to select, specified as keyword arguments.
The columns will be renamed to the keyword used.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>If you'd like to select a column whose name isn't a string (for example,
if you're working with pandas) then you should explicitly use <code>nw.col</code> instead
of just passing the column name. For example, to select a column named
<code>0</code> use <code>df.select(nw.col(0))</code>, not <code>df.select(0)</code>.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 4.5), (3, 2.) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">a_plus_1</span><span class="o">=</span><span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">┌────────────────────┐</span>
<span class="go">| Narwhals LazyFrame |</span>
<span class="go">|--------------------|</span>
<span class="go">|┌───────┬──────────┐|</span>
<span class="go">|│   a   │ a_plus_1 │|</span>
<span class="go">|│ int32 │  int32   │|</span>
<span class="go">|├───────┼──────────┤|</span>
<span class="go">|│     1 │        2 │|</span>
<span class="go">|│     3 │        4 │|</span>
<span class="go">|└───────┴──────────┘|</span>
<span class="go">└────────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.sink_parquet" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sink_parquet</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sink_parquet</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="n">BytesIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Write LazyFrame to Parquet file.</p>
<p>This may allow larger-than-RAM datasets to be written to disk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | <span title="io.BytesIO">BytesIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String, path object or file-like object to which the dataframe will be
written.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;bar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sink_parquet</span><span class="p">(</span><span class="s2">&quot;out.parquet&quot;</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.sort" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sort</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sort</span><span class="p">(</span>
    <span class="n">by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="n">more_by</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nulls_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sort the LazyFrame by the given columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="collections.abc.Iterable">Iterable</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) names to sort by.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*more_by</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional columns to sort by, specified as positional arguments.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>descending</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <span title="collections.abc.Sequence">Sequence</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sort in descending order. When sorting by multiple columns, can be
specified per column by passing a sequence of booleans.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nulls_last</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Place null values last; can specify a single boolean applying to
all columns or a sequence of booleans for per-column control.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="warning" open>
  <summary>Warning</summary>
  <p>Unlike Polars, it is not possible to specify a sequence of booleans for
<code>nulls_last</code> in order to control per-column behaviour. Instead a single
boolean is applied for all <code>by</code> columns.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT * FROM VALUES (1, 6.0, &#39;a&#39;), (2, 5.0, &#39;c&#39;), (NULL, 4.0, &#39;b&#39;) df(a, b, c)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="go">┌──────────────────────────────────┐</span>
<span class="go">|        Narwhals LazyFrame        |</span>
<span class="go">|----------------------------------|</span>
<span class="go">|┌───────┬──────────────┬─────────┐|</span>
<span class="go">|│   a   │      b       │    c    │|</span>
<span class="go">|│ int32 │ decimal(2,1) │ varchar │|</span>
<span class="go">|├───────┼──────────────┼─────────┤|</span>
<span class="go">|│  NULL │          4.0 │ b       │|</span>
<span class="go">|│     1 │          6.0 │ a       │|</span>
<span class="go">|│     2 │          5.0 │ c       │|</span>
<span class="go">|└───────┴──────────────┴─────────┘|</span>
<span class="go">└──────────────────────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.tail" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">tail</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">tail</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.to_native" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">to_native</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_native</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">LazyFrameT</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert Narwhals LazyFrame to native one.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 2), (3, 4) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌───────┬───────┐</span>
<span class="go">│   a   │   b   │</span>
<span class="go">│ int32 │ int32 │</span>
<span class="go">├───────┼───────┤</span>
<span class="go">│     1 │     2 │</span>
<span class="go">│     3 │     4 │</span>
<span class="go">└───────┴───────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.top_k" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">top_k</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">top_k</span><span class="p">(</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the <code>k</code> largest rows.</p>
<p>Non-null elements are always preferred over null elements,
regardless of the value of reverse. The output is not guaranteed
to be in any particular order, sort the outputs afterwards if you wish the output to be sorted.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rows to return.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="collections.abc.Iterable">Iterable</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) used to determine the top rows. Accepts expression input. Strings are parsed as column names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reverse</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <span title="collections.abc.Sequence">Sequence</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Consider the k smallest elements of the by column(s) (instead of the k largest).
This can be specified per column by passing a sequence of booleans.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT * FROM VALUES (&#39;a&#39;, 2), (&#39;b&#39;, 1), (&#39;a&#39;, 1), (&#39;b&#39;, 3), (NULL, 2), (&#39;c&#39;, 1) df(a, b)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">top_k</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">])</span>
<span class="go">┌───────────────────┐</span>
<span class="go">|Narwhals LazyFrame |</span>
<span class="go">|-------------------|</span>
<span class="go">|┌─────────┬───────┐|</span>
<span class="go">|│    a    │   b   │|</span>
<span class="go">|│ varchar │ int32 │|</span>
<span class="go">|├─────────┼───────┤|</span>
<span class="go">|│ b       │     3 │|</span>
<span class="go">|│ a       │     2 │|</span>
<span class="go">|│ NULL    │     2 │|</span>
<span class="go">|│ c       │     1 │|</span>
<span class="go">|└─────────┴───────┘|</span>
<span class="go">└───────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.unique" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">unique</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">unique</span><span class="p">(</span>
    <span class="n">subset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">keep</span><span class="p">:</span> <span class="n">UniqueKeepStrategy</span> <span class="o">=</span> <span class="s2">&quot;any&quot;</span><span class="p">,</span>
    <span class="n">order_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Drop duplicate rows from this LazyFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>subset</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name(s) to consider when identifying duplicate rows.
     If set to <code>None</code>, use all columns.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keep</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="UniqueKeepStrategy


  
      module-attribute
   (narwhals.typing.UniqueKeepStrategy)" href="../typing/#narwhals.typing.UniqueKeepStrategy">UniqueKeepStrategy</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>{'any', 'none', 'first', 'last}
Which of the duplicate rows to keep.</p>
<ul>
<li>'any': Does not give any guarantee of which row is kept.</li>
<li>'none': Don't keep duplicate rows.</li>
<li>'first': Keep the first row. Requires <code>order_by</code> to be specified.</li>
<li>'last': Keep the last row. Requires <code>order_by</code> to be specified.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;any&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order_by</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to order by when computing the row index.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 3), (1, 4) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">┌──────────────────┐</span>
<span class="go">|Narwhals LazyFrame|</span>
<span class="go">|------------------|</span>
<span class="go">|┌───────┬───────┐ |</span>
<span class="go">|│   a   │   b   │ |</span>
<span class="go">|│ int32 │ int32 │ |</span>
<span class="go">|├───────┼───────┤ |</span>
<span class="go">|│     1 │     3 │ |</span>
<span class="go">|└───────┴───────┘ |</span>
<span class="go">└──────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.unpivot" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">unpivot</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">unpivot</span><span class="p">(</span>
    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">variable_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Unpivot a DataFrame from wide to long format.</p>
<p>Optionally leaves identifiers set.</p>
<p>This function is useful to massage a DataFrame into a format where one or more
columns are identifier variables (index) while all other columns, considered
measured variables (on), are "unpivoted" to the row axis leaving just
two non-identifier columns, 'variable' and 'value'.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to use as values variables; if <code>on</code> is empty all columns that
are not in <code>index</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to use as identifier variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name to give to the <code>variable</code> column. Defaults to "variable".</p>
              </div>
            </td>
            <td>
                  <code>&#39;variable&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name to give to the <code>value</code> column. Defaults to "value".</p>
              </div>
            </td>
            <td>
                  <code>&#39;value&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>If you're coming from pandas, this is similar to <code>pandas.DataFrame.melt</code>,
but with <code>index</code> replacing <code>id_vars</code> and <code>on</code> replacing <code>value_vars</code>.
In other frameworks, you might know this operation as <code>pivot_longer</code>.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT * FROM VALUES (&#39;x&#39;, 1, 2), (&#39;y&#39;, 3, 4), (&#39;z&#39;, 5, 6) df(a, b, c)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">df_native</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">unpivot</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span>
<span class="go">┌─────────┬──────────┬───────┐</span>
<span class="go">│    a    │ variable │ value │</span>
<span class="go">│ varchar │ varchar  │ int32 │</span>
<span class="go">├─────────┼──────────┼───────┤</span>
<span class="go">│ x       │ b        │     1 │</span>
<span class="go">│ x       │ c        │     2 │</span>
<span class="go">│ y       │ b        │     3 │</span>
<span class="go">│ y       │ c        │     4 │</span>
<span class="go">│ z       │ b        │     5 │</span>
<span class="go">│ z       │ c        │     6 │</span>
<span class="go">└─────────┴──────────┴───────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.with_columns" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">with_columns</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">with_columns</span><span class="p">(</span>
    <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">IntoExpr</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">IntoExpr</span><span class="p">],</span>
    <span class="o">**</span><span class="n">named_exprs</span><span class="p">:</span> <span class="n">IntoExpr</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add columns to this LazyFrame.</p>
<p>Added columns will replace existing columns with the same name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*exprs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a> | <span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to add, specified as positional arguments.
     Accepts expression input. Strings are parsed as column names, other
     non-expression inputs are parsed as literals.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**named_exprs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IntoExpr


  
      module-attribute
   (narwhals.typing.IntoExpr)" href="../typing/#narwhals.typing.IntoExpr">IntoExpr</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional columns to add, specified as keyword arguments.
            The columns will be renamed to the keyword used.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Creating a new LazyFrame using this method does not create a new copy of
existing data.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 4.5), (3, 2.) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">nw</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">┌────────────────────────────────┐</span>
<span class="go">|       Narwhals LazyFrame       |</span>
<span class="go">|--------------------------------|</span>
<span class="go">|┌───────┬──────────────┬───────┐|</span>
<span class="go">|│   a   │      b       │   c   │|</span>
<span class="go">|│ int32 │ decimal(2,1) │ int32 │|</span>
<span class="go">|├───────┼──────────────┼───────┤|</span>
<span class="go">|│     1 │          4.5 │     2 │|</span>
<span class="go">|│     3 │          2.0 │     4 │|</span>
<span class="go">|└───────┴──────────────┴───────┘|</span>
<span class="go">└────────────────────────────────┘</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="narwhals.dataframe.LazyFrame.with_row_index" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">with_row_index</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">with_row_index</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">order_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Insert column which enumerates rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column as a string. The default is "index".</p>
              </div>
            </td>
            <td>
                  <code>&#39;index&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order_by</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) to order by when computing the row index.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">duckdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">narwhals</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf_native</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM VALUES (1, 5), (2, 4) df(a, b)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">┌──────────────────┐</span>
<span class="go">|Narwhals DataFrame|</span>
<span class="go">|------------------|</span>
<span class="go">|  pyarrow.Table   |</span>
<span class="go">|  index: int64    |</span>
<span class="go">|  a: int32        |</span>
<span class="go">|  b: int32        |</span>
<span class="go">|  ----            |</span>
<span class="go">|  index: [[0,1]]  |</span>
<span class="go">|  a: [[1,2]]      |</span>
<span class="go">|  b: [[5,4]]      |</span>
<span class="go">└──────────────────┘</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nw</span><span class="o">.</span><span class="n">from_native</span><span class="p">(</span><span class="n">lf_native</span><span class="p">)</span><span class="o">.</span><span class="n">with_row_index</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="go">┌──────────────────┐</span>
<span class="go">|Narwhals DataFrame|</span>
<span class="go">|------------------|</span>
<span class="go">|  pyarrow.Table   |</span>
<span class="go">|  index: int64    |</span>
<span class="go">|  a: int32        |</span>
<span class="go">|  b: int32        |</span>
<span class="go">|  ----            |</span>
<span class="go">|  index: [[1,0]]  |</span>
<span class="go">|  a: [[1,2]]      |</span>
<span class="go">|  b: [[5,4]]      |</span>
<span class="go">└──────────────────┘</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../lazy_group_by/" class="md-footer__link md-footer__link--prev" aria-label="Previous: narwhals.LazyGroupBy">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                narwhals.LazyGroupBy
              </div>
            </div>
          </a>
        
        
          
          <a href="../schema/" class="md-footer__link md-footer__link--next" aria-label="Next: narwhals.Schema">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                narwhals.Schema
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate", "navigation.footer", "navigation.indexes", "navigation.top"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>